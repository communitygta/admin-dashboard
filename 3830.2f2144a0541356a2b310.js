(self.webpackChunkcommunitygta_admin_panel=self.webpackChunkcommunitygta_admin_panel||[]).push([[3830],{3830:(t,n,e)=>{"use strict";e.r(n),e.d(n,{ProgramCreatePageModule:()=>Z});var o=e(8583),i=e(3679),r=e(3083),s=e(1182),a=e(263),c=e(2340),g=e(9827),l=e(639),d=e(5332),p=e(1352),u=e(4382),h=e(9075);function m(t,n){1&t&&(l.TgZ(0,"ion-text",24),l._uU(1,"(required)"),l.qZA())}function f(t,n){1&t&&(l.TgZ(0,"ion-text",24),l._uU(1,"(required) "),l.qZA())}function _(t,n){if(1&t&&(l.TgZ(0,"ion-select-option",25),l._uU(1),l.qZA()),2&t){const t=n.$implicit;l.Q6J("value",t.id),l.xp6(1),l.Oqu(t.name)}}function C(t,n){if(1&t){const t=l.EpF();l.TgZ(0,"ion-button",26),l.NdJ("click",function(){const n=l.CHM(t).$implicit;return l.oxw().toggleLanguage(n)}),l._uU(1),l.qZA()}if(2&t){const t=n.$implicit;l.ekj("selected",t.selected),l.xp6(1),l.Oqu(t.name)}}function O(t,n){if(1&t){const t=l.EpF();l.TgZ(0,"ion-button",26),l.NdJ("click",function(){const n=l.CHM(t).$implicit;return l.oxw().toggleFocus(n)}),l._uU(1),l.qZA()}if(2&t){const t=n.$implicit;l.ekj("selected",t.selected),l.xp6(1),l.Oqu(t.name)}}function P(t,n){if(1&t){const t=l.EpF();l.TgZ(0,"ion-button",26),l.NdJ("click",function(){const n=l.CHM(t).$implicit;return l.oxw().togglePopulationGroup(n)}),l._uU(1),l.qZA()}if(2&t){const t=n.$implicit;l.ekj("selected",t.selected),l.xp6(1),l.Oqu(t.name)}}const b=[{path:"",component:(()=>{class t{constructor(t,n,e,o,i,r,s){this.dashboardService=t,this.fb=n,this.inAppMessageService=e,this.appService=o,this.sanitizer=i,this.authService=r,this.navController=s,this.logoDomain=c.N.appUrl,this.defaultNewImageUrl="assets/images/add-image.svg",this.newImageUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.defaultNewImageUrl),this.editorConfig={modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline"]]},theme:"snow"},this.initForm()}ngOnInit(){this.dashboardService.getOptions({languages:"true",populationGroups:"true",focuses:"true"}).subscribe(t=>{this.languages=t.languages,this.focuses=t.focuses,this.populationGroups=t.populationGroups}),this.authService.userRole===a.i4.organizationAdmin&&(this.organizationId=this.authService.userProfile$.getValue().profile.organization.id),this.authService.userRole===a.i4.neighbourhoodAdmin&&this.getOrganizationSelections(this.authService.userProfile$.getValue().profile.neighbourhood.id),this.authService.userRole===a.i4.superAdmin&&(this.availableOrganizations$=this.dashboardService.getAllOrganizations()),this.initForm(),this.initAddVideoLinkForm(),this.initAddImageForm(),this.setupQuillEditors()}getOrganizationSelections(t){this.availableOrganizations$=this.dashboardService.getOrganizationsByNeighbourhoodId(t)}setupQuillEditors(){setTimeout(()=>{this.descriptionEditor=new Quill("#descriptionEditor",this.editorConfig);const t=this.descriptionEditor.clipboard.convert("");this.descriptionEditor.setContents(t,"api"),this.descriptionEditor.on("text-change",()=>{const t=new g.bc(this.descriptionEditor.getContents().ops,{}).convert();this.form.controls.description.setValue(t),this.form.markAsDirty()}),this.eligibilityEditor=new Quill("#eligibilityEditor",this.editorConfig);const n=this.eligibilityEditor.clipboard.convert("");this.eligibilityEditor.setContents(n,"silent"),this.eligibilityEditor.on("text-change",()=>{const t=new g.bc(this.eligibilityEditor.getContents().ops,{}).convert();this.form.controls.eligibility.setValue(t),this.form.markAsDirty()}),this.frequencyEditor=new Quill("#frequencyEditor",this.editorConfig);const e=this.frequencyEditor.clipboard.convert("");this.frequencyEditor.setContents(e,"silent"),this.frequencyEditor.on("text-change",()=>{const t=new g.bc(this.frequencyEditor.getContents().ops,{}).convert();this.form.controls.frequency.setValue(t),this.form.markAsDirty()}),this.howToApplyEditor=new Quill("#howToApplyEditor",this.editorConfig);const o=this.howToApplyEditor.clipboard.convert("");this.howToApplyEditor.setContents(o,"silent"),this.howToApplyEditor.on("text-change",()=>{const t=new g.bc(this.howToApplyEditor.getContents().ops,{}).convert();this.form.controls.how_to_apply.setValue(t),this.form.markAsDirty()})},500)}initForm(){this.form=this.fb.group({description:[null],eligibility:[null],enabled:[!1],fee:[null],focuses:[null],frequency:[null],how_to_apply:[null],id:[null],images:[null],languages:[null],location:[null],name:[null,[i.kI.required]],neighbourhoods:[null],organization:[this.organizationId,[i.kI.required]],population_groups:[null],staff_contact:[null],staff_name:[null],video_links:[null],view_count:[0]})}initAddVideoLinkForm(){this.addVideoLinkForm=this.fb.group({name:[null,[i.kI.required]],link:[null,[i.kI.required]],program:[this.form.get("id").value]})}initAddImageForm(){this.addImageForm=this.fb.group({name:[null,[i.kI.required]],image:[null,[i.kI.required]],program:[this.form.get("id").value]})}removeVideoLink(t,n,e){this.dashboardService.removeProgramVideoLink(t).subscribe(t=>{n.video_links.splice(e,1)})}addVideoLink(t){this.addVideoLinkForm.invalid||this.dashboardService.addProgramVideoLink(this.addVideoLinkForm.value).subscribe(n=>{this.addVideoLinkForm.reset(),this.inAppMessageService.simpleToast("A new video link has been added.","bottom"),t.video_links.push(n)})}toggleLanguage(t){this.form.markAsDirty(),t.selected=!t.selected}togglePopulationGroup(t){this.form.markAsDirty(),t.selected=!t.selected}toggleFocus(t){this.form.markAsDirty(),t.selected=!t.selected}toggleNeighbourhood(t){this.form.markAsDirty(),t.selected=!t.selected}newImageOnChange(t){if(t.target.files.length>0){const n=t.target.files[0];this.newImageUrl=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(n)),this.addImageForm.get("image").setValue(n)}}addNewImage(t){this.addImageForm.invalid||this.dashboardService.addProgramImage(this.addImageForm.value).subscribe(n=>{this.addImageForm.reset(),this.inAppMessageService.simpleToast("A new image has been added.","bottom");const e=Object.assign({},n);e.image=this.logoDomain+n.image,t.images.push(e),this.newImageUrl=this.defaultNewImageUrl})}removeImage(t,n,e){this.dashboardService.removeProgramImage(t).subscribe(t=>{n.images.splice(e,1),this.inAppMessageService.simpleToast("Removed.","bottom")})}create(){if(this.form.invalid)return this.form.markAllAsTouched(),void this.inAppMessageService.simpleToast("Please fill in all required fields.","bottom");const t=Object.assign({},this.form.value);t.neighbourhoods=[];const n=this.languages.filter(t=>t.selected),e=this.populationGroups.filter(t=>t.selected),o=this.focuses.filter(t=>t.selected);t.languages=n,t.population_groups=e,t.focuses=o,this.dashboardService.createProgram(t).subscribe(t=>{this.inAppMessageService.simpleAlert("Message","Program has been created.","OK",!1,()=>this.navController.navigateForward(`program-edit/${t.id}`))})}}return t.\u0275fac=function(n){return new(n||t)(l.Y36(d.s),l.Y36(i.qu),l.Y36(p.r),l.Y36(u.z),l.Y36(h.H7),l.Y36(a.e8),l.Y36(r.SH))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-program-create"]],decls:76,vars:11,consts:[["slot","start"],["text","",3,"defaultHref"],["slot","end"],["fill","solid","expand","block","color","primary",3,"disabled","click"],["name","save-outline"],[1,"content-wrapper"],[3,"formGroup"],[1,"field-item"],["color","danger",4,"ngIf"],["formControlName","name"],["id","descriptionEditor"],["formControlName","location"],["id","eligibilityEditor"],["formControlName","fee"],["id","frequencyEditor"],["id","howToApplyEditor"],["placeholder","Select","formControlName","organization"],[3,"value",4,"ngFor","ngForOf"],[1,"multiple-selection"],["fill","outline",3,"selected","click",4,"ngFor","ngForOf"],["formControlName","staff_name"],["formControlName","staff_contact"],["lines","full"],["slot","end","formControlName","enabled"],["color","danger"],[3,"value"],["fill","outline",3,"click"]],template:function(t,n){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l._UZ(3,"ion-back-button",1),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5,"Create Program"),l.qZA(),l.TgZ(6,"ion-buttons",2),l.TgZ(7,"ion-button",3),l.NdJ("click",function(){return n.create()}),l._UZ(8,"ion-icon",4),l._uU(9," \xa0 Create "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(10,"ion-content"),l.TgZ(11,"div",5),l.TgZ(12,"form",6),l.TgZ(13,"div",7),l.TgZ(14,"h2"),l._uU(15,"Name "),l.YNc(16,m,2,0,"ion-text",8),l.qZA(),l._UZ(17,"ion-input",9),l.qZA(),l.TgZ(18,"div",7),l.TgZ(19,"h2"),l._uU(20,"Description"),l.qZA(),l._UZ(21,"div",10),l.qZA(),l.TgZ(22,"div",7),l.TgZ(23,"h2"),l._uU(24,"Location"),l.qZA(),l._UZ(25,"ion-input",11),l.qZA(),l.TgZ(26,"div",7),l.TgZ(27,"h2"),l._uU(28,"Eligibility"),l.qZA(),l._UZ(29,"div",12),l.qZA(),l.TgZ(30,"div",7),l.TgZ(31,"h2"),l._uU(32,"Fee"),l.qZA(),l._UZ(33,"ion-input",13),l.qZA(),l.TgZ(34,"div",7),l.TgZ(35,"h2"),l._uU(36,"Frequency"),l.qZA(),l._UZ(37,"div",14),l.qZA(),l.TgZ(38,"div",7),l.TgZ(39,"h2"),l._uU(40,"How To Apply"),l.qZA(),l._UZ(41,"div",15),l.qZA(),l.TgZ(42,"div",7),l.TgZ(43,"h2"),l._uU(44,"Select an organization "),l.YNc(45,f,2,0,"ion-text",8),l.qZA(),l.TgZ(46,"ion-select",16),l.YNc(47,_,2,2,"ion-select-option",17),l.ALo(48,"async"),l.qZA(),l.qZA(),l.TgZ(49,"div",7),l.TgZ(50,"h2"),l._uU(51,"Languages"),l.qZA(),l.TgZ(52,"div",18),l.YNc(53,C,2,3,"ion-button",19),l.qZA(),l.qZA(),l.TgZ(54,"div",7),l.TgZ(55,"h2"),l._uU(56,"Focuses"),l.qZA(),l.TgZ(57,"div",18),l.YNc(58,O,2,3,"ion-button",19),l.qZA(),l.qZA(),l.TgZ(59,"div",7),l.TgZ(60,"h2"),l._uU(61,"Population Groups"),l.qZA(),l.TgZ(62,"div",18),l.YNc(63,P,2,3,"ion-button",19),l.qZA(),l.qZA(),l.TgZ(64,"div",7),l.TgZ(65,"h2"),l._uU(66,"Staff Name"),l.qZA(),l._UZ(67,"ion-input",20),l.qZA(),l.TgZ(68,"div",7),l.TgZ(69,"h2"),l._uU(70,"Staff Contact"),l.qZA(),l._UZ(71,"ion-input",21),l.qZA(),l.TgZ(72,"ion-item",22),l.TgZ(73,"ion-label"),l._uU(74,"Enabled"),l.qZA(),l._UZ(75,"ion-toggle",23),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&t&&(l.xp6(3),l.Q6J("defaultHref","/programs"),l.xp6(4),l.Q6J("disabled",!n.form.dirty),l.xp6(5),l.Q6J("formGroup",n.form),l.xp6(4),l.Q6J("ngIf",n.form.controls.name.touched&&n.form.controls.name.invalid),l.xp6(29),l.Q6J("ngIf",n.form.controls.organization.touched&&n.form.controls.organization.invalid),l.xp6(2),l.Q6J("ngForOf",l.lcZ(48,9,n.availableOrganizations$)),l.xp6(6),l.Q6J("ngForOf",n.languages),l.xp6(5),l.Q6J("ngForOf",n.focuses),l.xp6(5),l.Q6J("ngForOf",n.populationGroups))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.YG,r.gu,r.W2,i._Y,i.JL,i.sg,o.O5,r.pK,r.j9,i.JJ,i.u,r.t9,r.QI,o.sg,r.Ie,r.Q$,r.ho,r.w,r.yW,r.n0],pipes:[o.Ov],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{margin:30px;border-radius:15px;box-shadow:0 3px 10px #0003;overflow:hidden;padding:10px 0;position:relative}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{position:relative}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:20px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:300px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]{margin:12px 0 10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-style:dashed;--border-width:1px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]   ion-button.selected[_ngcontent-%COMP%]{--border-style:solid;--border-width:1px;--background:var(--ion-color-primary);--color:#fff}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]{margin:20px;border:1px solid #ddd;padding:16px;border-radius:10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:700;color:#444}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd;padding-left:16px;font-size:14px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   .add-video-link[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;margin:5px 0;outline:none;box-shadow:none;border:1px solid #999;border-radius:4px;width:300px;padding-left:6px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:20px;border:1px solid #ddd;padding:16px;border-radius:10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:700;color:#444;width:100%}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:250px;margin:20px 10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .add-image-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;height:150px;align-items:center;justify-content:center;background:#eee;cursor:pointer}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:14px;color:#444;display:flex;justify-content:space-between;min-height:35px;line-height:30px;align-items:stretch}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;outline:none;box-shadow:none;border:1px solid #999;border-radius:4px;padding-left:6px;max-width:100%}"]}),t})()}];let M=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[s.Bz.forChild(b)],s.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[o.ez,i.u5,i.UX,r.Pc,M]]}),t})()}}]);