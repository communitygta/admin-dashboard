(self.webpackChunkcommunitygta_admin_panel=self.webpackChunkcommunitygta_admin_panel||[]).push([[3204],{3204:(n,o,e)=>{"use strict";e.r(o),e.d(o,{UserCreatePageModule:()=>z});var t=e(8583),i=e(3679),r=e(3083),a=e(131),s=e(263),l=e(639),c=e(5315),g=e(1352);function u(n,o){1&n&&l._UZ(0,"ion-icon",17)}function p(n,o){1&n&&l._UZ(0,"ion-icon",18)}function h(n,o){1&n&&l._UZ(0,"ion-icon",17)}function d(n,o){1&n&&l._UZ(0,"ion-icon",18)}function m(n,o){1&n&&l._UZ(0,"ion-icon",17)}function f(n,o){1&n&&l._UZ(0,"ion-icon",18)}function _(n,o){if(1&n&&(l.TgZ(0,"ion-select-option",21),l._uU(1),l.qZA()),2&n){const n=o.$implicit;l.Q6J("value",n.value),l.xp6(1),l.hij("",n.name," ")}}function Z(n,o){if(1&n&&(l.TgZ(0,"ion-select",19),l.YNc(1,_,2,2,"ion-select-option",20),l.qZA()),2&n){const n=l.oxw();l.xp6(1),l.Q6J("ngForOf",n.availableUserRoles)}}function w(n,o){if(1&n&&(l.TgZ(0,"ion-label",22),l._uU(1),l.qZA()),2&n){const n=l.oxw();l.xp6(1),l.Oqu(n.availableUserRoles[1].name)}}function O(n,o){1&n&&l._UZ(0,"ion-icon",17)}function C(n,o){1&n&&l._UZ(0,"ion-icon",18)}function b(n,o){if(1&n&&(l.TgZ(0,"ion-select-option",21),l._uU(1),l.qZA()),2&n){const n=o.$implicit;l.Q6J("value",n.id),l.xp6(1),l.hij(" ",n.name,"")}}function P(n,o){if(1&n&&(l.TgZ(0,"ion-item",4),l.TgZ(1,"ion-label"),l._uU(2,"Neighbourhood "),l.YNc(3,O,1,0,"ion-icon",5),l.YNc(4,C,1,0,"ion-icon",6),l.qZA(),l.TgZ(5,"ion-select",23),l.YNc(6,b,2,2,"ion-select-option",20),l.ALo(7,"async"),l.qZA(),l.qZA()),2&n){const n=l.oxw();l.xp6(3),l.Q6J("ngIf",n.neighbourhood.dirty&&n.neighbourhood.valid),l.xp6(1),l.Q6J("ngIf",n.neighbourhood.dirty&&n.neighbourhood.invalid),l.xp6(2),l.Q6J("ngForOf",l.lcZ(7,3,n.availableNeighbourhoods$))}}function M(n,o){1&n&&l._UZ(0,"ion-icon",17)}function v(n,o){1&n&&l._UZ(0,"ion-icon",18)}function x(n,o){if(1&n&&(l.TgZ(0,"ion-select-option",21),l._uU(1),l.qZA()),2&n){const n=o.$implicit;l.Q6J("value",n.id),l.xp6(1),l.Oqu(n.name)}}function A(n,o){if(1&n&&(l.TgZ(0,"ion-item",4),l.TgZ(1,"ion-label"),l._uU(2,"Organization "),l.YNc(3,M,1,0,"ion-icon",5),l.YNc(4,v,1,0,"ion-icon",6),l.qZA(),l.TgZ(5,"ion-select",24),l.YNc(6,x,2,2,"ion-select-option",20),l.ALo(7,"async"),l.qZA(),l.qZA()),2&n){const n=l.oxw();l.xp6(3),l.Q6J("ngIf",n.organization.dirty&&n.organization.valid),l.xp6(1),l.Q6J("ngIf",n.organization.dirty&&n.organization.invalid),l.xp6(2),l.Q6J("ngForOf",l.lcZ(7,3,n.availableOrganizations$))}}const U=[{path:"",component:(()=>{class n{constructor(n,o,e,t,i){this.fb=n,this.authService=o,this.dashboardService=e,this.inAppMessageService=t,this.navController=i,this.showOrganizations=!1,this.showNeighbourhoods=!1,this.showUserRoles=!1,this.availableUserRoles=[{value:1,name:"Neighbourhood Admin"},{value:2,name:"Organization Admin"}],this.initForm()}ngOnInit(){}get username(){return this.form.controls.username}get email(){return this.form.controls.email}get password(){return this.form.controls.password}get userRole(){return this.form.controls.userRole}get neighbourhood(){return this.form.controls.neighbourhood}get organization(){return this.form.controls.organization}create(){if(this.form.invalid)return this.organization.invalid&&this.inAppMessageService.simpleToast("Please select an organization","bottom"),this.neighbourhood.invalid&&this.inAppMessageService.simpleToast("Please select a neighbourhood","bottom"),void(this.userRole.invalid&&this.inAppMessageService.simpleToast("Please select a user role","bottom"));1===this.userRole.value?delete this.form.value.organization:delete this.form.value.neighbourhood,delete this.form.value.userRole,this.authService.createUserByAdmin(this.form.value).subscribe(n=>{this.inAppMessageService.simpleAlert(null,"The new user has been created.","OK",!1,()=>this.navController.navigateBack("user-list"))})}initForm(){this.form=this.fb.group({username:[null,[i.kI.required]],email:[null,[i.kI.required,i.kI.email]],password:[null,[i.kI.required,i.kI.minLength(8),i.kI.maxLength(16),i.kI.pattern(/^(?=.*[\d])(?=.*[a-zA-Z])[\w]{8,16}$/)]],userRole:[null,[i.kI.required]],organization:[null],neighbourhood:[null]}),this.authService.userRole===s.i4.superAdmin&&(this.showUserRoles=!0,this.availableNeighbourhoods$=this.dashboardService.getAllNeighbourhoods(),this.availableOrganizations$=this.dashboardService.getAllOrganizations()),this.authService.userRole===s.i4.neighbourhoodAdmin&&(this.showOrganizations=!0,this.form.controls.userRole.patchValue(this.availableUserRoles[0].value),this.form.controls.organization.setValidators([i.kI.required]),this.availableOrganizations$=this.dashboardService.getOrganizationsByNeighbourhoodId(this.authService.userProfile$.getValue().profile.neighbourhood.id)),this.userRole.valueChanges.subscribe(n=>{1===n&&(this.showNeighbourhoods=!0,this.showOrganizations=!1,this.neighbourhood.setValidators([i.kI.required]),this.organization.clearValidators(),this.organization.setValue(null)),2===n&&(this.showOrganizations=!0,this.showNeighbourhoods=!1,this.organization.setValidators([i.kI.required]),this.neighbourhood.clearValidators(),this.neighbourhood.setValue(null))})}}return n.\u0275fac=function(o){return new(o||n)(l.Y36(i.qu),l.Y36(s.e8),l.Y36(c.s),l.Y36(g.r),l.Y36(r.SH))},n.\u0275cmp=l.Xpm({type:n,selectors:[["app-user-create"]],decls:50,vars:13,consts:[["slot","start"],["text","",3,"defaultHref"],[1,"wrapper"],[1,"content-wrapper",3,"formGroup"],["lines","none"],["name","checkmark-circle","color","success",4,"ngIf"],["name","alert-circle","color","warning",4,"ngIf"],["readonly","","formControlName","username","placeholder","user name","autocorrect","off","spellcheck","false","autocomplete","off",3,"ionFocus"],["usernameInput",""],["formControlName","email","placeholder","email","autocorrect","off","spellcheck","false","autocomplete","off"],["formControlName","password","type","password","placeholder","password","autocorrect","off","spellcheck","false","autocomplete","off"],["formControlName","userRole","placeholder","select a user role",4,"ngIf"],["slot","end",4,"ngIf"],["lines","none",4,"ngIf"],["size","small",3,"disabled","click"],["name","save-outline"],[1,"content-wrapper","password-rules"],["name","checkmark-circle","color","success"],["name","alert-circle","color","warning"],["formControlName","userRole","placeholder","select a user role"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end"],["formControlName","neighbourhood","placeholder","select an neighbourhood"],["formControlName","organization","placeholder","select an organization"]],template:function(n,o){if(1&n){const n=l.EpF();l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l._UZ(3,"ion-back-button",1),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5,"Create User"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"ion-content"),l.TgZ(7,"div",2),l.TgZ(8,"form",3),l.TgZ(9,"ion-item",4),l.TgZ(10,"ion-label"),l._uU(11,"User Name "),l.YNc(12,u,1,0,"ion-icon",5),l.YNc(13,p,1,0,"ion-icon",6),l.qZA(),l.TgZ(14,"ion-input",7,8),l.NdJ("ionFocus",function(){return l.CHM(n),l.MAs(15).readonly=!1}),l.qZA(),l.qZA(),l.TgZ(16,"ion-item",4),l.TgZ(17,"ion-label"),l._uU(18,"Email "),l.YNc(19,h,1,0,"ion-icon",5),l.YNc(20,d,1,0,"ion-icon",6),l.qZA(),l._UZ(21,"ion-input",9),l.qZA(),l.TgZ(22,"ion-item",4),l.TgZ(23,"ion-label"),l._uU(24,"Password "),l.YNc(25,m,1,0,"ion-icon",5),l.YNc(26,f,1,0,"ion-icon",6),l.qZA(),l._UZ(27,"ion-input",10),l.qZA(),l.TgZ(28,"ion-item",4),l.TgZ(29,"ion-label"),l._uU(30,"User Role"),l.qZA(),l.YNc(31,Z,2,1,"ion-select",11),l.YNc(32,w,2,1,"ion-label",12),l.qZA(),l.YNc(33,P,8,5,"ion-item",13),l.YNc(34,A,8,5,"ion-item",13),l.TgZ(35,"ion-button",14),l.NdJ("click",function(){return o.create()}),l._UZ(36,"ion-icon",15),l._uU(37," Create "),l.qZA(),l.qZA(),l.TgZ(38,"div",16),l.TgZ(39,"p"),l._uU(40,"Password rules:"),l.qZA(),l.TgZ(41,"ul"),l.TgZ(42,"li"),l._uU(43,"Password must contain 8 to 16 characters"),l.qZA(),l.TgZ(44,"li"),l._uU(45,"Password must contain at least one number and one letter"),l.qZA(),l.TgZ(46,"li"),l._uU(47,"Password must not contain a special character"),l.qZA(),l.TgZ(48,"li"),l._uU(49,"Password must not be a commonly used password"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()}2&n&&(l.xp6(3),l.Q6J("defaultHref","/user-list"),l.xp6(5),l.Q6J("formGroup",o.form),l.xp6(4),l.Q6J("ngIf",o.username.dirty&&o.username.valid),l.xp6(1),l.Q6J("ngIf",o.username.dirty&&o.username.invalid),l.xp6(6),l.Q6J("ngIf",o.email.dirty&&o.email.valid),l.xp6(1),l.Q6J("ngIf",o.email.dirty&&o.email.invalid),l.xp6(5),l.Q6J("ngIf",o.password.dirty&&o.password.valid),l.xp6(1),l.Q6J("ngIf",o.password.dirty&&o.password.invalid),l.xp6(5),l.Q6J("ngIf",o.showUserRoles),l.xp6(1),l.Q6J("ngIf",!o.showUserRoles),l.xp6(1),l.Q6J("ngIf",o.showNeighbourhoods),l.xp6(1),l.Q6J("ngIf",o.showOrganizations),l.xp6(1),l.Q6J("disabled",!o.form.dirty))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.W2,i._Y,i.JL,i.sg,r.Ie,r.Q$,t.O5,r.pK,r.j9,i.JJ,i.u,r.YG,r.gu,r.t9,r.QI,t.sg,r.n0],pipes:[t.Ov],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;align-items:self-start;flex-wrap:wrap}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{margin:30px;border-radius:15px;box-shadow:0 3px 10px #0003;overflow:hidden;padding:10px 0;position:relative;width:420px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper.password-rules[_ngcontent-%COMP%]{padding-left:16px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper.password-rules[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#444}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper.password-rules[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{font-size:13px;padding-left:20px;color:#707070}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px;color:#444}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:13px;color:#707070;padding-bottom:15px;padding-top:15px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:230px;max-width:100%;font-size:14px;text-align:right}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{font-size:14px;text-align:right}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{float:right;margin-top:10px;margin-right:20px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .content-wrapper.update-password[_ngcontent-%COMP%]{width:300px}"]}),n})()}];let q=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=l.oAB({type:n}),n.\u0275inj=l.cJS({imports:[[a.Bz.forChild(U)],a.Bz]}),n})(),z=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=l.oAB({type:n}),n.\u0275inj=l.cJS({imports:[[t.ez,i.u5,i.UX,r.Pc,q]]}),n})()}}]);