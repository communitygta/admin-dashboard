(self.webpackChunkcommunitygta_admin_panel=self.webpackChunkcommunitygta_admin_panel||[]).push([[7605],{7605:(n,e,t)=>{"use strict";t.r(e),t.d(e,{OrganizationEditPageModule:()=>b});var o=t(8583),i=t(3679),a=t(3083),r=t(131),g=t(3342),s=t(2340),c=t(639),l=t(263),d=t(5332),p=t(1352),m=t(2186),u=t(9075);function _(n,e){if(1&n){const n=c.EpF();c.TgZ(0,"img",44),c.NdJ("click",function(){return c.CHM(n),c.oxw(),c.MAs(16).click()}),c.qZA()}if(2&n){const n=c.oxw(2);c.Q6J("src",n.logo.value,c.LSH)}}function h(n,e){if(1&n){const n=c.EpF();c.TgZ(0,"ion-button",45),c.NdJ("click",function(){const e=c.CHM(n).$implicit;return c.oxw(2).toggleLanguage(e)}),c._uU(1),c.qZA()}if(2&n){const n=e.$implicit;c.ekj("selected",n.selected),c.xp6(1),c.Oqu(n.name)}}function f(n,e){if(1&n){const n=c.EpF();c.TgZ(0,"div",46),c.TgZ(1,"p"),c._uU(2),c._UZ(3,"br"),c.TgZ(4,"a",47),c._uU(5),c.qZA(),c.qZA(),c.TgZ(6,"ion-button",34),c.NdJ("click",function(){const e=c.CHM(n),t=e.$implicit,o=e.index,i=c.oxw().ngIf;return c.oxw().removeVideoLink(t,i,o)}),c._UZ(7,"ion-icon",48),c.qZA(),c.qZA()}if(2&n){const n=e.$implicit;c.xp6(2),c.Oqu(n.name),c.xp6(2),c.Q6J("href",n.link,c.LSH),c.xp6(1),c.Oqu(n.link)}}function Z(n,e){if(1&n){const n=c.EpF();c.TgZ(0,"ion-card"),c.TgZ(1,"a",47),c._UZ(2,"img",49),c.qZA(),c.TgZ(3,"ion-card-header"),c.TgZ(4,"ion-card-title",50),c._uU(5),c.TgZ(6,"ion-button",43),c.NdJ("click",function(){const e=c.CHM(n),t=e.$implicit,o=e.index,i=c.oxw().ngIf;return c.oxw().removeImage(t,i,o)}),c._UZ(7,"ion-icon",48),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&n){const n=e.$implicit;c.xp6(1),c.Q6J("href",n.image,c.LSH),c.xp6(1),c.Q6J("src",n.image,c.LSH),c.xp6(2),c.Q6J("title",n.name),c.xp6(1),c.hij("",n.name," ")}}function C(n,e){if(1&n){const n=c.EpF();c.ynx(0),c.TgZ(1,"ion-header"),c.TgZ(2,"ion-toolbar"),c.TgZ(3,"ion-buttons",1),c._UZ(4,"ion-back-button",2),c.qZA(),c.TgZ(5,"ion-title"),c._uU(6,"Edit Organization"),c.qZA(),c.TgZ(7,"ion-buttons",3),c.TgZ(8,"ion-button",4),c.NdJ("click",function(){return c.CHM(n),c.oxw().save()}),c._UZ(9,"ion-icon",5),c._uU(10," \xa0 Save "),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"ion-content"),c.TgZ(12,"div",6),c.TgZ(13,"form",7),c.YNc(14,_,1,1,"img",8),c.TgZ(15,"input",9,10),c.NdJ("change",function(e){return c.CHM(n),c.oxw().onChange(e)}),c.qZA(),c.TgZ(17,"ion-item"),c.TgZ(18,"ion-label",11),c._uU(19,"Name"),c.qZA(),c._UZ(20,"ion-input",12),c.qZA(),c.TgZ(21,"ion-item"),c.TgZ(22,"ion-label",11),c._uU(23,"Mission"),c.qZA(),c._UZ(24,"ion-textarea",13),c.qZA(),c.TgZ(25,"ion-item"),c.TgZ(26,"ion-label",11),c._uU(27,"Email"),c.qZA(),c._UZ(28,"ion-input",14),c.qZA(),c.TgZ(29,"ion-item"),c.TgZ(30,"ion-label",11),c._uU(31,"Phone"),c.qZA(),c._UZ(32,"ion-input",15),c.qZA(),c.TgZ(33,"ion-item"),c.TgZ(34,"ion-label",11),c._uU(35,"Website"),c.qZA(),c._UZ(36,"ion-input",16),c.qZA(),c.TgZ(37,"ion-item"),c.TgZ(38,"ion-label",11),c._uU(39,"Address"),c.qZA(),c._UZ(40,"ion-input",17),c.qZA(),c.TgZ(41,"ion-item"),c.TgZ(42,"ion-label",11),c._uU(43,"Postal Code"),c.qZA(),c._UZ(44,"ion-input",18),c.qZA(),c.TgZ(45,"ion-item",19),c.TgZ(46,"ion-label",11),c._uU(47,"Languages"),c.qZA(),c.TgZ(48,"div",20),c.YNc(49,h,2,3,"ion-button",21),c.qZA(),c.qZA(),c.TgZ(50,"ion-item"),c.TgZ(51,"ion-label",11),c._uU(52,"Charity Number"),c.qZA(),c._UZ(53,"ion-input",22),c.qZA(),c.TgZ(54,"ion-item"),c.TgZ(55,"ion-label",11),c._uU(56,"Profile Code"),c.qZA(),c._UZ(57,"ion-input",23),c.qZA(),c.TgZ(58,"ion-item"),c.TgZ(59,"ion-label",11),c._uU(60,"Full-time Staff"),c.qZA(),c._UZ(61,"ion-input",24),c.qZA(),c.TgZ(62,"ion-item"),c.TgZ(63,"ion-label",11),c._uU(64,"Part-time Staff"),c.qZA(),c._UZ(65,"ion-input",25),c.qZA(),c.TgZ(66,"ion-item"),c.TgZ(67,"ion-label",11),c._uU(68,"Founded"),c.qZA(),c._UZ(69,"ion-input",26),c.qZA(),c.TgZ(70,"ion-item"),c.TgZ(71,"ion-label",11),c._uU(72,"View Count"),c.qZA(),c._UZ(73,"ion-input",27),c.qZA(),c.qZA(),c.TgZ(74,"form",28),c.TgZ(75,"h2"),c._uU(76,"Video Links"),c.qZA(),c.YNc(77,f,8,3,"div",29),c.TgZ(78,"div",30),c.TgZ(79,"p",31),c._UZ(80,"input",32),c._UZ(81,"br"),c._UZ(82,"input",33),c.qZA(),c.TgZ(83,"ion-button",34),c.NdJ("click",function(){const e=c.CHM(n).ngIf;return c.oxw().addVideoLink(e)}),c._UZ(84,"ion-icon",35),c.qZA(),c.qZA(),c.qZA(),c.TgZ(85,"form",36),c.TgZ(86,"h2"),c._uU(87,"Images"),c.qZA(),c.YNc(88,Z,8,4,"ion-card",37),c.TgZ(89,"ion-card"),c.TgZ(90,"div",38),c.NdJ("click",function(){return c.CHM(n),c.MAs(93).click()}),c._UZ(91,"img",39),c.TgZ(92,"input",40,41),c.NdJ("change",function(e){return c.CHM(n),c.oxw().newImageOnChange(e)}),c.qZA(),c.qZA(),c.TgZ(94,"ion-card-header"),c.TgZ(95,"ion-card-title"),c._UZ(96,"input",42),c.TgZ(97,"ion-button",43),c.NdJ("click",function(){const e=c.CHM(n).ngIf;return c.oxw().addNewImage(e)}),c._UZ(98,"ion-icon",5),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.BQk()}if(2&n){const n=e.ngIf,t=c.oxw();c.xp6(8),c.Q6J("disabled",!t.form.dirty),c.xp6(5),c.Q6J("formGroup",t.form),c.xp6(1),c.Q6J("ngIf",t.logo.value),c.xp6(35),c.Q6J("ngForOf",t.languages),c.xp6(25),c.Q6J("formGroup",t.addVideoLinkForm),c.xp6(3),c.Q6J("ngForOf",n.video_links),c.xp6(8),c.Q6J("formGroup",t.addImageForm),c.xp6(3),c.Q6J("ngForOf",n.images),c.xp6(3),c.Q6J("src",t.newImageUrl,c.LSH)}}const O=[{path:"",component:(()=>{class n{constructor(n,e,t,o,i,a,r){this.authService=n,this.dashboardService=e,this.activatedRoute=t,this.fb=o,this.inAppMessageService=i,this.appService=a,this.sanitizer=r,this.logoDomain=s.N.appUrl,this.languages=this.appService.appData.Language,this.defaultNewImageUrl="assets/images/add-image.svg",this.newImageUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.defaultNewImageUrl),this.organization$=this.dashboardService.getOrganizationById(this.activatedRoute.snapshot.params.id).pipe((0,g.b)(n=>{this.languages.map(e=>(e.selected=!!n.languages.find(n=>n.id===e.id),e)),this.form.patchValue(n),this.initAddVideoLinkForm(),this.initAddImageForm()})),this.initForm()}ngOnInit(){}get logo(){return this.form.controls.logo}initForm(){this.form=this.fb.group({address:[null],charity_number:[null],email:[null],founded:[null],full_time_staff:[null],id:[null],images:[null],languages:[null],logo:[null],mission:[null],name:[null],neighbourhood:this.fb.group({id:[null],name:[null],total_population:[null]}),part_time_staff:[null],phone:[null],postal_code:[null],profile_code:[null],video_links:[null],view_count:[null],website:[null]})}initAddVideoLinkForm(){this.addVideoLinkForm=this.fb.group({name:[null,[i.kI.required]],link:[null,[i.kI.required]],organization:[this.form.get("id").value]})}initAddImageForm(){this.addImageForm=this.fb.group({name:[null,[i.kI.required]],image:[null,[i.kI.required]],organization:[this.form.get("id").value]})}removeVideoLink(n,e,t){this.dashboardService.removeOrganiztionVideoLink(n).subscribe(n=>{e.video_links.splice(t,1)})}addVideoLink(n){this.addVideoLinkForm.invalid||this.dashboardService.addOrganizationVideoLink(this.addVideoLinkForm.value).subscribe(e=>{this.addVideoLinkForm.reset(),this.inAppMessageService.simpleToast("A new video link has been added.","bottom"),n.video_links.push(e)})}toggleLanguage(n){this.form.markAsDirty(),n.selected=!n.selected}onChange(n){if(n.target.files.length>0){const e=n.target.files[0];this.updateLogo(this.form.get("id").value,e)}}newImageOnChange(n){if(n.target.files.length>0){const e=n.target.files[0];this.newImageUrl=this.sanitizer.bypassSecurityTrustResourceUrl(URL.createObjectURL(e)),this.addImageForm.get("image").setValue(e)}}addNewImage(n){this.addImageForm.invalid||this.dashboardService.addOrganizationImage(this.addImageForm.value).subscribe(e=>{this.addImageForm.reset(),this.inAppMessageService.simpleToast("A new image has been added.","bottom");const t=Object.assign({},e);t.image=this.logoDomain+e.image,n.images.push(t),this.newImageUrl=this.defaultNewImageUrl})}removeImage(n,e,t){this.dashboardService.removeOrganizationImage(n).subscribe(n=>{e.images.splice(t,1),this.inAppMessageService.simpleToast("Removed.","bottom")})}updateLogo(n,e){this.dashboardService.updateOrganizationLogo({id:n,logo:e}).subscribe(n=>{this.logo.patchValue(this.logoDomain+n.logo),this.inAppMessageService.simpleAlert("Message","Organization logo has been updated.")})}save(){const n=Object.assign({},this.form.value);delete n.logo,delete n.neighbourhood;const e=this.languages.filter(n=>n.selected);n.languages=e,this.dashboardService.updateOrganization(n).subscribe(n=>{this.inAppMessageService.simpleAlert("Message","Organization has been updated."),this.form.patchValue(n),this.form.markAsPristine()})}}return n.\u0275fac=function(e){return new(e||n)(c.Y36(l.e8),c.Y36(d.s),c.Y36(r.gz),c.Y36(i.qu),c.Y36(p.r),c.Y36(m.z),c.Y36(u.H7))},n.\u0275cmp=c.Xpm({type:n,selectors:[["app-organization-edit"]],decls:2,vars:3,consts:[[4,"ngIf"],["slot","start"],["defaultHref","organization","text",""],["slot","end"],["fill","solid","expand","block","color","primary",3,"disabled","click"],["name","save-outline"],[1,"content-wrapper"],[3,"formGroup"],["width","200",3,"src","click",4,"ngIf"],["type","file","hidden","","accept","image/jpg, image/jpeg, image/png",3,"change"],["logoInput",""],["position","stacked"],["formControlName","name"],["formControlName","mission","autoGrow",""],["formControlName","email"],["formControlName","phone"],["formControlName","website"],["formControlName","address"],["formControlName","postal_code"],["lines","full"],[1,"languages-selection"],["fill","outline",3,"selected","click",4,"ngFor","ngForOf"],["formControlName","charity_number"],["formControlName","profile_code"],["formControlName","full_time_staff"],["formControlName","part_time_staff"],["formControlName","founded"],["readonly","","formControlName","view_count"],[1,"video-links",3,"formGroup"],["class","link-item",4,"ngFor","ngForOf"],["lines","full",1,"add-video-link","link-item"],[1,"ion-text-wrap"],["placeholder","new video title","type","text","formControlName","name"],["placeholder","new video link","type","text","formControlName","link"],["fill","clear","slot","end","size","large",1,"icon-only",3,"click"],["name","add-outline"],[1,"images",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"add-image-wrapper",3,"click"],["title","add a new image",3,"src"],["type","file","hidden","","accept","image/*",3,"change"],["newImage",""],["placeholder","new image title","formControlName","name"],["fill","clear","size","small",1,"icon-only",3,"click"],["width","200",3,"src","click"],["fill","outline",3,"click"],[1,"link-item"],["target","_blank",3,"href"],["name","trash-outline"],[3,"src"],[3,"title"]],template:function(n,e){1&n&&(c.YNc(0,C,99,9,"ng-container",0),c.ALo(1,"async")),2&n&&c.Q6J("ngIf",c.lcZ(1,1,e.organization$))},directives:[o.O5,a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.YG,a.gu,a.W2,i._Y,i.JL,i.sg,a.Ie,a.Q$,a.pK,a.j9,i.JJ,i.u,a.g2,o.sg,i.Fj,a.PM,a.Zi,a.gZ],pipes:[o.Ov],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{margin:30px;border-radius:15px;box-shadow:0 3px 10px #0003;overflow:hidden;padding:10px 0}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:20px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:220px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]{margin:12px 0 10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-style:dashed;--border-width:1px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .languages-selection[_ngcontent-%COMP%]   ion-button.selected[_ngcontent-%COMP%]{--border-style:solid;--border-width:1px;--background:var(--ion-color-primary);--color:#fff}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]{margin:20px;border:1px solid #ddd;padding:16px;border-radius:10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:700;color:#444}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd;padding-left:16px;font-size:14px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .video-links[_ngcontent-%COMP%]   .add-video-link[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;margin:5px 0;outline:none;box-shadow:none;border:1px solid #999;border-radius:4px;width:300px;padding-left:6px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:20px;border:1px solid #ddd;padding:16px;border-radius:10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:700;color:#444;width:100%}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{width:250px;margin:20px 10px}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .add-image-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;height:150px;align-items:center;justify-content:center;background:#eee;cursor:pointer}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:14px;color:#444;display:flex;justify-content:space-between;min-height:35px;line-height:30px;align-items:stretch}[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:14px;outline:none;box-shadow:none;border:1px solid #999;border-radius:4px;padding-left:6px;max-width:100%}"]}),n})()}];let M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[[r.Bz.forChild(O)],r.Bz]}),n})(),b=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=c.oAB({type:n}),n.\u0275inj=c.cJS({imports:[[o.ez,i.u5,i.UX,a.Pc,M]]}),n})()}}]);